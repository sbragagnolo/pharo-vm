debug support
recordTrace: classOrInteger thing: selector source: source
	"This method includes or excludes CoInterpreterMT methods as required.
	 It used to be auto-generated by CogVMSimulator>>ensureMultiThreadingOverridesAreUpToDate.
	 Now checks for or collects expectedSends."
	(expectedSends == nil
	 or: [objectMemory isIntegerObject: classOrInteger]) ifFalse:
		[expecting
			ifTrue:
				[expectedSends peek ~~ selector ifTrue: [self halt].
				 expectedSends next]
			ifFalse:
				[expectedSends nextPut: selector]].
	
	^self perform: #recordTrace:thing:source:
		withArguments: {classOrInteger. selector. source}
		inSuperclass: (cogThreadManager ifNil: [CoInterpreterPrimitives] ifNotNil: [CoInterpreterMT])